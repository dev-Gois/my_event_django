{% load static %}
{% load compress %}

{% compress css %}
  <link rel="stylesheet" type="text/x-scss" href="{% static 'styles/components/styled_table.scss' %}" media="screen">
{% endcompress %}

<table class="events-table">
  <thead>
    <tr>
      <th>Data<i class="fa-solid fa-calendar"></i></th>
      <th>Hora<i class="fa-solid fa-clock"></i></th>
      {% if user_is_organizer %}
        <th>Ações<i class="fa-solid fa-cogs"></i></th>
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for schedule in schedules %}
      <tr>
        <td>{{ schedule.date }}</td>
        <td>{{ schedule.time }}</td>
        {% if user_is_organizer %}
          <td class="actions">
            <a href="{% url 'edit_schedule' schedule.id %}">
              <i class="fa-solid fa-edit"></i>
            </a>
            <a data-url="{% url 'delete_schedule' schedule.id %}" onclick="deleteSchedule(this)">
              <i class="fa-solid fa-trash"></i>
            </a> 
          </td>
        {% endif %}
      </tr>
    {% endfor %}
  </tbody>
</table>

<script>
  const deleteSchedule = (button) => {
    const scheduleUrl = button.getAttribute('data-url');
    
    return Swal.fire({
      title: 'Você tem certeza?',
      text: "Você não poderá reverter isso!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      cancelButtonText: 'Cancelar',
      confirmButtonText: 'Sim, deletar!'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = scheduleUrl;
      }
    });
  }
</script>